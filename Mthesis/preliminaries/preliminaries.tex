% !TeX root = ../mthesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US

\chapter{Preliminaries}

\input{epigraphs/defintion}

We assume familiarity with propositional and predicate logic \cite{Huth:2004:LCS:975331}, 
automated theorem proving \cite{Fitting:1996:FLA:230183}, 
term rewriting \cite{Baader:1998:TR:280474}, 
decision procedures \cite{Kroening:2008:DPA:1391237}, 
and (maximum) satisfiability testing \cite{Biere:2009:HSV:1550723}.
Even so, for clarity we introduce basic
definitions and state basic lemmas and theorems without proofs.
This section is an extension of the same section in our seminar report \cite{axm:SR2}
where notions and notations largely follow those in lecture notes \cite{AM2015tr} and \cite{GM2013ar}.


\section{Syntax}

\input{preliminaries/signature}

\input{preliminaries/terms}

\input{preliminaries/atoms}

%In examples we usually use $\ma,\mb,\mc,\md$ for constants $c\in\mcFfO$,
%$\mf,\mg,\mh$ for function symbols $f\in\mcFfgo$,
%$\mpp,\mq,\mr$ for propositions $p\in\mcFPO$, and 
%$\mP,\mQ,\mR$ for predicate symbols $P\in\mcFPgo$.
%The special binary equality symbol $\mEQ$ is always available.
% and can be seen as special predicate ${\mEQ}\in\mcFP^{(2)}$.

\input{preliminaries/fof}

\input{preliminaries/cnf}

\input{preliminaries/substitution}

\input{preliminaries/unifier}

\section{Semantics}

\begin{definition}
	An {\myem interpretation} $\mcI$ over a signature $\mcF$ consists 
	of a {\myem universe}, i.e.~non-empty set  $A$,
	the definitions of functions $\mf^\mcI: A^n\rightarrow A$  for every function symbol $\mf\in\mcFf$, 
	and definitions of possibly empty relations $\mEQ^\mcI\subseteq A^2$ for the equality symbol 
	and ${\mP^\mcI}\subseteq A^n$ for every predicate symbol $\mP\in\mcFP$.
%	
	An {\myem equational} interpretation interprets the equality symbol as equality on its domain.
\end{definition}

\begin{definition}\label{def:termmodel}
	%A ground literal $L$ holds in an Herbrand {\myem interpretation} $\mathcal I$ (a domain of ground terms and definitions for functions and predicates), 
	%if it is the logical consequence $\mathcal I\models L$ of ground literals in $\mathcal I$.
	%A non-ground literal holds in $\mathcal I$, if all its ground instances hold in $\mathcal I$.
	%A clause holds in $\mathcal I$, if at least one of its literals holds in $\mathcal I$.
	%A set of clauses $S$ holds in $\mathcal I$, if every clause $\mathcal C\in S$ holds in $\mathcal I$.
	%An interpretation is consistent $\mathcal I\not\models\square$, if no pair of complementary literals holds in $\mathcal I$.
	%A set of clauses $S$ is {\myem satisfiable} if it has a {\myem model} $\mathcal M$, i.e.~a consistent interpretation $\mathcal M\models S$.
	A {\myem Herbrand interpretation}  $\mcH$ is an interpretation where the elements of the domain are ground terms
	and the interpretation of each ground term $t^\mcH := t$ is the term itself.
	A {\myem term interpretation} $\mcM$ is an equational interpretation where the elements of the domain $A$ 
	are equivalence classes of ground terms
	and the interpretation of each ground term $t^\mcM := [t]_\sim$ is its equivalence class.
	An equation $s\mEQ t$ of ground terms holds in $\mcM$ if $[s]_\sim=[t]_\sim$;
	a ground predicate $\mP(t_1,\ldots,t_n)$ holds in $\mcM$ if $\mP([t_1]_\sim,\ldots,[t_n]_\sim)] \in A^n$.
	A ground literal holds in $\mcM$ if and only if its complementary literal does not hold in $\mcM$.
	
	A non-ground literal holds in $\mcM$ if all its 
	%(infinitely many in the presence of function symbols with arity greater than one) 
	(perhaps infinitely many)
	instances hold in $\mcM$.
	A clause holds in $\mcM$, if at least one of its literals holds in $\mcM$.
	A set of clauses $S$ holds in $\mcM$, if every clause $\mcC\in S$ holds in $\mcM$.
	Then we say $\mcM$ is a model {\em for} $S$.
	
\end{definition}

\section{Term Rewriting}

\begin{definition}\label{def:position}
	A {\myem position} is a finite sequence of positive integers.
	The root position is the empty sequence $\epsilon$.
	Position $pq$ is obtained by concatenation of positions $p$ and $q$.
	%
	The set of all positions of a term or literal is defined as 
	\DEFINE{ 
		\pos(\mct) }
	{
		\{ \epsilon \} 		
		& \text{if }\mct = x \in \mcV \\
%		
		\{ \epsilon \} \cup \bigcup_{i=1}^{n} \{ iq\mid q\in\pos(t_i) \}	
		& \text{if }\mct=\mcf(t_1,\ldots,t_n)\text{ where } \mcf\in\mcF^{(n)}.
	}
The~{\myem subterm} $\mct|_p$ of term $t$ {\myem at position} $p\in\pos(t)$ is defined as
%
\DEFINE{
	t|_p
}{
	t 		& \text{if }p=\epsilon \\
	t_i|_q	& \text{if }t=\mkf(t_1,\ldots,t_n)\text{ and }p=iq
}
%
If $s$ is a term then $t[s]_p$ represents the term build by replacing the subterm of $t$ at position $p$ with the term $s$.
\DEFINE{
	t[s]_p}
{
	s 		& \text{if }p=\epsilon \\
	\mf(t_1,\ldots,t_i[s]_q,\ldots,t_n)	& \text{if }t=\mf(t_1,\ldots,t_n)\text{ and }p=iq
}
%A {\myem hole} denotes a special constant symbol $\ctxhole\in\mcFf^{(0)}$. 
%A {\myem context} is a term $t$ with exactly one hole, i.e.~one occurrence $|t|_{\ctxhole}=1$.
\end{definition}

\begin{definition}
	A {\myem rewrite rule} is an equation of terms where the left-hand side is not a variable
	and the variables occuring in the right-hand side occur also in the left-hand side.
%	\[
%		\ell\rwEQ r \text{ is rewrite rule }\quad :\Longleftrightarrow\quad\ell\not\in\mcV\text{ and }\var(r)\subseteq\var(l)
%	\] 
	A rewrite rule $\ell'\rwEQ r'$ is a {\myem variant} of $\ell\rwEQ r$ if there is a renaming $\varrho$
	such that 
	$(l\rightarrow r)\varrho = l'\rightarrow r'$.
	A {\myem term rewrite system} is a set of rewrite rules without variants.

	We say $s\rightarrow_\mcR t$ is a 
	{\myem rewrite step} 
	 with respect to TRS $\mcR$ 
	when there is a position $p \in \pos(s)$, 
	a rewrite rule $l\rwEQ r\in\mcR$, 
	and a substitution $\sigma$ such that
	$s|_p=l\sigma$ and $s[r\sigma]_p = t$.
		The subterm $l\sigma$ is called {\myem redex} and
	$s$ rewrites to $t$ by {\myem contracting} $l\sigma$ to {\myem contractum} $r\sigma$.
	%
	We say a term $s$ is {\myem irreducible} or in {\myem normal form} with respect to TRS $\mcR$ if there is no rewrite step $s\rightarrow_\mcR t$ for any term $t$. 
	The set of normal forms $\mNFR$ contains all irreducible terms of the TRS $\mcR$.
	\end{definition}

%\begin{definition}
%	A {\myem rewrite relation} is a binary relation on terms that is closed under contexts and substitutions.
%	A {\myem rewrite order} is a proper order (i.e. irreflexive and transitive relation) and a rewrite relation.
%	A {\myem reduction order} is a well-founded rewrite order.
%\end{definition}

\begin{definition}
	A term $s$ can be rewritten to term $t$ with notion $s\rightarrow^*_\mcR t$ 
	if there exists at least one {\myem rewrite sequence} $(a_1,\ldots ,a_n)$ such that
	$s=a_1$, $a_n=t$, and $a_i\rightarrow_\mcR a_{i+1}$ are rewrite steps for $1\leq i<n$.
	A TRS is {\myem terminating} if there is no infinite rewrite sequence of terms.
	%
	Two Terms $s$ and $t$ are {\myem joinable} with notion $s\downarrow t$ 
	if both can be rewritten to some term $c$, i.e.~$s \rightarrow^*c\ \, ^*\!\!\leftarrow t$.
%	
	Two Terms $s$ and $t$ are {\myem meetable} with notion $s\uparrow t$ 
	if both can be rewritten from some common ancestor term $a$, i.e.~$s \leftarrow^*a\ \, ^*\!\!\rightarrow t$.
%
	A TRS is {\myem confluent } if $s$ and $t$ are joinable whenever $s\ ^*\!\!\leftarrow a \rightarrow^* t$ holds for some term $a$.
	%
	Terms $s$ and $t$ are {\myem convertible} with notion $s\leftrightarrow^* t$ 
	if there exists a sequence $(a_1,\ldots ,a_n)$ such that
	$s=a_1$, $a_n=t$, and $a_i\leftrightarrow a_{i+1}$, i.e.~$a_i\rightarrow a_{i+1}$ or $a_i\leftarrow a_{i+1}$ are rewrite steps for $1\leq i<n$.
\end{definition}

\begin{definition}\label{def:closed-under}
	A {\myem rewrite relation} is a binary relation $\relation$ on terms thats is {\myem closed under contexts},
	i.e.~$u[s]_p\relation u[t]_p$ %holds 
	for all positions $p\in\pos(u)$ and
	for all terms $s,t,u$ whenever $s\relation t$
	and {\myem closed under substitutions}, 
	i.e.~$s\sigma\relation t\sigma$ %holds
	for all substitutions $\sigma$
	and all terms $s,t$ whenever $s\relation t$.
\end{definition}
\begin{lemma}
	The relations $\rightarrow^*_\mcR$, 
	$\rightarrow^+_\mcR$,
	$\downarrow_\mcR$, $\uparrow_\mcR$ are rewrite relations on every TRS $\mcR$.
\end{lemma}
%
\begin{definition}
	A proper (i.e.~irreflexive and transitive) order on terms is called {\myem rewrite order} if it is a rewrite relation.
	A {\myem reduction order} is a well-founded rewrite order,
	i.e.~there is no infinite sequence 
	$(a_i)_{i\in\mathbb{N}}$
	where $a_i\gtpre a_{i+1}$ for all $i$.
	% with $i\in\mathbb{N}$.
	A {\myem simplification order} is a rewrite order with the {\myem subterm property},
	i.e.~$u[t]_p \gtpre t$ for all terms $u$, $t$ and positions $p\neq\epsilon$.
\end{definition}
\begin{lemma}
	Every simplification order is well-founded, i.e.~it is a reduction order.
\end{lemma}
%% DEF %%
%
\begin{theorem}
	A TRS $\mcR$ is terminating if and only if there exists a reduction order $\gtpre$
	such that $l\gtpre r$ for every rewrite rule $l\rightarrow r\in\mcR$.
	We call $\mcR$ simply terminating if $\gtpre$ is a simplification order.
\end{theorem}
