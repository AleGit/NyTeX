% !TeX root = ../mthesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US

\chapter{Preliminaries}

\input{epigraphs/defintion}

We assume familiarity with propositional and predicate logic \cite{Huth:2004:LCS:975331}, 
automated theorem proving \cite{Fitting:1996:FLA:230183}, 
term rewriting \cite{Baader:1998:TR:280474}, 
decision procedures \cite{Kroening:2008:DPA:1391237}, 
and (maximum) satisfiability testing \cite{Biere:2009:HSV:1550723}.
Even so, for clarity we introduce basic
definitions and state basic lemmas and theorems without proofs.
This section is an extension of the same section in our seminar report \cite{axm:SR2}
where notions and notations largely follow those in lecture notes \cite{AM2015tr} and \cite{GM2013ar}.


\section{Syntax}

\input{preliminaries/signature}

\input{preliminaries/terms}

\input{preliminaries/atoms}

\input{preliminaries/ground}

\input{preliminaries/fof}

\input{preliminaries/cnf}

\input{preliminaries/substitution}

\input{preliminaries/unifier}

\section{Semantics}

In this section we recall some basic aspects and definitions of semantics in first order logic. 
We state satisfiability of clauses. For brevity we ignore arbitrary formulas in first order logic
in our definitions.

\begin{definition}
	An {\myem interpretation} $\mcI$ over a signature $\mcF$ consists of a
	non-empty set $A$ -- the {\myem universe} or {\myem domain},
	definitions of (partial) functions $\mf_\mcI: A^n\rightarrow A$ for every function symbol $\mf\in\mcFf$, 
	and definitions of (possibly empty) n-ary relations 
	 ${\mP_\mcI}\subseteq A^n$ for every predicate symbol $\mP\in\mcFP$
	 and the definition of a binary relation ${\mEQ_\mcI}\subseteq A^2$ for the equality symbol.
	 An {\myem equational} interpretation defines $\mEQ_\mcI$ as equality on its domain.
	 i.e.~a ground term $s \mEQ_\mcI t$ holds if and only if $s_\mcI = t_\mcI$.
	
	A ground predicate $\mP(t_1,\ldots,t_n)$ {\myem holds} in interpretation $\mcI$ 
	if and only if $(t_1,\ldots,t_n) \in \mP_\mcI$.
	A ground literal does not hold in $\mcI$ if and only if its complementary literal holds in $\mcI$.
%	
	A non-ground literal holds in $\mcI$ if all its 
	(perhaps infinitely many) ground
	instances hold in $\mcI$.
	A clause holds in $\mcI$ if at least one of its literals holds in $\mcI$.
	A set of clauses $S$ holds in $\mcI$ if every clause $\mcC\in S$ holds in $\mcI$.
	We say $\mcI$ is a model {\em for} $S$ if $S$ holds in $\mcI$. 
	
	
\end{definition}

\begin{definition}
	A set of clauses $S$ is {\myem satisfiable} if and only if there is a model $\mcM$ for $S$. 
	A set of clauses is  {\myem valid} if and only if all clauses hold in every interpretation.
\end{definition}

\begin{definition}\label{def:hk}
	An {\myem Herbrand universe} is the smallest set of terms that contains all $H_k\ge 0$ of
	\begin{align*}
	H_0 &:= \left\{ 
	\begin{array}{ll}
	\{ \mc \mid \mc\in\mcFfn[0] \}Â 
	&\text{if } \mcFfn[0]\not=\emptyset\\
	\{ \mc \}
	&\text{if } \mcFfn[0]=\emptyset, \mc\not\in\mcF
	\end{array}
	\right. 
	\\
	H_{k+1} &:= H_k \cup \{\  
	\mf(t_1,\ldots,t_n) \mid
	\mf\in\mcFfn[n],
	t_1,\ldots,t_n \in H_k
	\ \}
	\end{align*}
	
\end{definition}

\begin{definition}
	An {\myem Herbrand interpretation} $\mcH$ is an interpretation where the domain 
	is an Hebrand universe
	and the interpretation of each ground term $t_\mcH := t$ is the term itself.
\end{definition}

\begin{example}
	Consider the satisfiable set of clauses 
	$S = \{  
		\mP(\mf(x)) 
	\}$. 
	Let $H_S = \{ 
		\mc, \mf(\mc), \mf(\mc), \ldots, \mf^i(\mc), \ldots
	\}$ be the Hebrand universe for $S$.
	We define $\mf_I$ by mapping $\mc_I := \mc$,
	$\mf_I^{i+1}(x) := \mf (\mf_I^i(x))$
\end{example}

\begin{definition}
	An {\myem term interpretation} 
	$\mcI_t$ 
	is an interpretation 
	where the elements of its domain $A = \mcTFf/_\sim$ 
		are equivalence classes of ground terms
		and the interpretation of each ground term $t^{\mcI_t} := [t]_\sim$ is its equivalence class.
%		An equation $s\mEQ t$ of ground terms holds in if $[s]_\sim=[t]_\sim$.
	 A ground predicate $\mP(t_1,\ldots,t_n)$ holds if 
	 $([t_1]_\sim,\ldots,[t_n]_\sim) \in \mP^{\mcI_t} \subseteq A^n$.
%	A ground literal does not hold if and only if its complementary literal holds.
	In an {\myem equational} term interpretation an equation $s\mEQ t$ holds if an only if $s\sim t$.
	
\end{definition}

\begin{example}
	Consider the satisfiable set of clauses $S = \{ x \mEQ \mf(x) \}$. 
%	
	We easily find a Herbrand model $\mcH$ with
	predicate definition $\mEQ^\mcH = \{ (\mf^{i}(\ma)), \mf^{i+1}(\ma)) \mid i\geq 0  \} $. 
	However $\mcH$ is not an equational model because obviously $\ma\neq\mf(\ma)$ in its domain.
%	
	Further on we easily find an equational model $\mcM$ 
	with domain $\{ \mc \}$, function definition $\mf^\mcM(\mc) = \mc$, 
	and $\mEQ_\mcM$ is defined by equality in its domain.
	Certainly this model $\mcM$ is not an Hebrand model 
	because the interpretation of ground term ${\mf(\mc)}^\mcM \neq \mf(\mc)$ is not the term itself.
	
	On the other hand we easily get an equational term model with domain $\{ [\ma]_\sim\}$, 
	a plain function definition
	$\mf([\ma]_\sim) = [\ma]_\sim$, 
	and an equivalence relation
	$\ma \sim \mf(\ma)$
	where $\mEQ$ is defined by equality in its domain.	
\end{example}


%\section{Term Rewriting}
%
%
%
%
%\begin{definition}
%	A {\myem rewrite rule} is an equation of terms where the left-hand side is not a variable
%	and the variables occuring in the right-hand side occur also in the left-hand side.
%	%	\[
%	%		\ell\rwEQ r \text{ is rewrite rule }\quad :\Longleftrightarrow\quad\ell\not\in\mcV\text{ and }\var(r)\subseteq\var(l)
%	%	\] 
%	A rewrite rule $\ell'\rwEQ r'$ is a {\myem variant} of $\ell\rwEQ r$ if there is a renaming $\varrho$
%	such that 
%	$(l\rightarrow r)\varrho = l'\rightarrow r'$.
%	A {\myem term rewrite system} is a set of rewrite rules without variants.
%\end{definition}
%
%\begin{definition}\label{def:position}
%	A {\myem position} is a finite sequence of positive integers.
%	The root position is the empty sequence $\epsilon$.
%	The position $pq$ is obtained by concatenation of positions $p$ and $q$.
%	%
%	The set of all positions of an expression $\mct$ is defined as 
%	\DEFINE{ 
%		\pos(\mct) }
%	{
%		\{ \epsilon \} 		
%		& \text{if }\mct = x \in \mcV \\
%%		
%		\{ \epsilon \} \cup \bigcup_{i=1}^{n} \{ iq\mid q\in\pos(t_i) \}	
%		& \text{if }\mct=\mcf(t_1,\ldots,t_n)\text{ where } \mcf\in\mcF^{(n)}.
%	}
%The~{\myem subexpression} $\mct|_p$ of an expression $\mct$ {\myem at position} $p\in\pos(\mct)$ is defined as
%%
%\DEFINE{
%	t|_p
%}{
%	t 		& \text{if }p=\epsilon \\
%	t_i|_q	& \text{if }t=\mcf(t_1,\ldots,t_n)\text{ and }p=iq
%}
%%
%If $s$ is an expression then $t[s]_p$ represents the expression build by replacing the subexpression of $t$ at position $p$ with the term $s$.
%\DEFINE{
%	t[s]_p}
%{
%	s 		& \text{if }p=\epsilon \\
%	\mf(t_1,\ldots,t_i[s]_q,\ldots,t_n)	& \text{if }t=\mf(t_1,\ldots,t_n)\text{ and }p=iq
%}
%%A {\myem hole} denotes a special constant symbol $\ctxhole\in\mcFf^{(0)}$. 
%%A {\myem context} is a term $t$ with exactly one hole, i.e.~one occurrence $|t|_{\ctxhole}=1$.
%\end{definition}
%
%\begin{definition}
%	We say $s\rightarrow_\mcR t$ is a 
%	{\myem rewrite step} 
%	 with respect to TRS $\mcR$ 
%	when there is a position $p \in \pos(s)$, 
%	a rewrite rule $l\rwEQ r\in\mcR$, 
%	and a substitution $\sigma$ such that
%	$s|_p=l\sigma$ and $s[r\sigma]_p = t$.
%		The subterm $l\sigma$ is called {\myem redex} and
%	$s$ rewrites to $t$ by {\myem contracting} $l\sigma$ to {\myem contractum} $r\sigma$.
%	%
%	We say a term $s$ is {\myem irreducible} or in {\myem normal form} with respect to TRS $\mcR$ if there is no rewrite step $s\rightarrow_\mcR t$ for any term $t$. 
%	The set of normal forms $\mNFR$ contains all irreducible terms of the TRS $\mcR$.
%	\end{definition}
%
%%\begin{definition}
%%	A {\myem rewrite relation} is a binary relation on terms that is closed under contexts and substitutions.
%%	A {\myem rewrite order} is a proper order (i.e. irreflexive and transitive relation) and a rewrite relation.
%%	A {\myem reduction order} is a well-founded rewrite order.
%%\end{definition}
%
%\begin{definition}
%	A term $s$ can be rewritten to term $t$ with notion $s\rightarrow^*_\mcR t$ 
%	if there exists at least one {\myem rewrite sequence} $(a_1,\ldots ,a_n)$ such that
%	$s=a_1$, $a_n=t$, and $a_i\rightarrow_\mcR a_{i+1}$ are rewrite steps for $1\leq i<n$.
%	A TRS is {\myem terminating} if there is no infinite rewrite sequence of terms.
%	%
%	Two Terms $s$ and $t$ are {\myem joinable} with notion $s\downarrow t$ 
%	if both can be rewritten to some term $c$, i.e.~$s \rightarrow^*c\ \, ^*\!\!\leftarrow t$.
%%	
%	Two Terms $s$ and $t$ are {\myem meetable} with notion $s\uparrow t$ 
%	if both can be rewritten from some common ancestor term $a$, i.e.~$s \leftarrow^*a\ \, ^*\!\!\rightarrow t$.
%%
%	A TRS is {\myem confluent } if $s$ and $t$ are joinable whenever $s\ ^*\!\!\leftarrow a \rightarrow^* t$ holds for some term $a$.
%	%
%	Terms $s$ and $t$ are {\myem convertible} with notion $s\leftrightarrow^* t$ 
%	if there exists a sequence $(a_1,\ldots ,a_n)$ such that
%	$s=a_1$, $a_n=t$, and $a_i\leftrightarrow a_{i+1}$, i.e.~$a_i\rightarrow a_{i+1}$ or $a_i\leftarrow a_{i+1}$ are rewrite steps for $1\leq i<n$.
%\end{definition}
%
%\begin{definition}\label{def:closed-under}
%	A {\myem rewrite relation} is a binary relation $\relation$ on terms thats is {\myem closed under contexts},
%	i.e.~$u[s]_p\relation u[t]_p$ %holds 
%	for all positions $p\in\pos(u)$ and
%	for all terms $s,t,u$ whenever $s\relation t$
%	and {\myem closed under substitutions}, 
%	i.e.~$s\sigma\relation t\sigma$ %holds
%	for all substitutions $\sigma$
%	and all terms $s,t$ whenever $s\relation t$.
%\end{definition}
%\begin{lemma}
%	The relations $\rightarrow^*_\mcR$, 
%	$\rightarrow^+_\mcR$,
%	$\downarrow_\mcR$, $\uparrow_\mcR$ are rewrite relations on every TRS $\mcR$.
%\end{lemma}
%%
%\begin{definition}
%	A proper (i.e.~irreflexive and transitive) order on terms is called {\myem rewrite order} if it is a rewrite relation.
%	A {\myem reduction order} is a well-founded rewrite order,
%	i.e.~there is no infinite sequence 
%	$(a_i)_{i\in\mathbb{N}}$
%	where $a_i\gtpre a_{i+1}$ for all $i$.
%	% with $i\in\mathbb{N}$.
%	A {\myem simplification order} is a rewrite order with the {\myem subterm property},
%	i.e.~$u[t]_p \gtpre t$ for all terms $u$, $t$ and positions $p\neq\epsilon$.
%\end{definition}
%\begin{lemma}
%	Every simplification order is well-founded, i.e.~it is a reduction order.
%\end{lemma}
%%% DEF %%
%%
%\begin{theorem}
%	A TRS $\mcR$ is terminating if and only if there exists a reduction order $\gtpre$
%	such that $l\gtpre r$ for every rewrite rule $l\rightarrow r\in\mcR$.
%	We call $\mcR$ simply terminating if $\gtpre$ is a simplification order.
%\end{theorem}

\section{Usefull theorems}

\begin{theorem}[Church 1936, Turing 1937]
The satisfiability problem for first order logic is undecidable
\end{theorem}

\begin{theorem}[Compactness]\label{the:compactness}
	If every finite subset of a set of formulas $S$ has a model then $S$ has a model. 
\end{theorem}

\begin{theorem}[LÃ¶wenheim Skolem]\label{the:loewenheim}
	If a set of formulas $S$ has a model then $S$ has a countable model.
\end{theorem}

\begin{theorem}[Herbrand]\label{the:herbrand}
	Let $S$ be a set of clauses without equality. Then the following statements are equivalent.
	\begin{itemize}
		\item $S$ is satisfiable.
		\item $S$ has a Herbrand model.
		\item Every finite subset of all ground instances of $S$ has a Herbrand model.
	\end{itemize} 
\end{theorem}

\begin{corollary}
	Let $S$ be a set of clauses without equality. 
	Then $S$ is unsatisfiable if and only if there exists 
	an unsatisfiable finite set of ground instances of $S$.
\end{corollary}

%\section{Conventions}
%
%\begin{align*}
%\mc, \md &\ \in\mcFfn[{0}]\tag*{constant symbols} \\
%\mf, \mg, \mh &\ \in\mcFfn[{n>0}]\tag*{function symbols} \\
%\mpp, \mq, \mr &\ \in\mcFPn[{0}]\tag*{propositional symbols}\\
%\mP, \mQ, \mR &\ \in\mcFPn[{n>0}]\tag*{predicate symbols}\\
%s,t,u &\ \in\mcTf = \mcTFfV\tag*{terms}
%\end{align*}


