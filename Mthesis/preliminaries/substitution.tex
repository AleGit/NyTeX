% !TeX root = ../mthesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US

% In the following definitions $\mcf$ denotes a function symbol, a predicate symbol or the equality sign.


\begin{definition}\label{def:substitution}
	A {\myem substitution} $\sigma$ is a mapping from variables $x\in\mcV$ to terms in $\mcTFfV$
	where the {\myem domain }$\domain(\sigma) = \{ x\in\mcV\mid\sigma(x) \neq x \}$ is finite.
	We write substitutions as bindings, e.g.~$\sigma=\{ x_1\mapsto s_1,\ldots,x_n\mapsto s_n \}$
	where $\domain(\sigma)=\{ x_1,\ldots,x_n \}$ and $\sigma(x_i)=s_i$.
	A {\myem variable substitution} is a mapping from $\mcV$ to $\mcV\subseteq\mcTFfV$.
	A {\myem renaming} is a bijective variable substitution.
	A {\myem proper instantiator} is a substitution that is not a variable substitution.
	We define the instance $\mct\sigma$ of a first order expression
	respectively the application of a substitution $\sigma$ to a first order expression $\mct$ as follows
	\DEFINE{
		\mct\sigma
	}{
			s_i 				& \text{if }\mct=x_i\in\domain(\sigma)
			\\
			y					& \text{if }\mct=y\in\mcV\,\backslash\domain(\sigma)
			\\
			\mcf(\mct_1\sigma,\ldots,\mct_n\sigma)	&\text{if }\mct=\mcf(\mct_1,\ldots,\mct_n) 
			\text{ where  }
			 \mcf\in\mcFn 
%			 \tag*{\footnotemark}
			\\
%			P(t_1\sigma,\ldots,t_n\sigma)	&\text{if }\mct=P(t_1,\ldots,t_n), P\in\mcFPn \\
%			s\sigma\mEQ t\sigma			&\text{if }\mct=s\mEQ t \\[0.5em]
			\lnot(A\sigma)					&\text{if }\mct=\lnot A
			\text{ where $A$ is an atom}
%			\in\mcPT\disjointunion\mcET  
			\\
%			L_1\sigma\lor\ldots\lor L_n\sigma	&\text{if }\mct=L_1\lor\ldots\lor L_n 
%			\text{ where $L_1,\ldots,L_n$ are literals}
%			\\	
}

\noindent We define the instance of a clause as the multiset of the instances of its literals.
\end{definition}
%\footnotetext{We use prefix and infix notation interchangable, e.g.
%${\mEQ}(s,t)$ represents the same equation as $s\mEQ t$.}

\begin{definition}\label{def:substcomp}
We define the {\myem composition} of two substitutions $\sigma$ and $\tau$ as follows
	\begin{align*}
		\sigma\tau&=\{ x_i\mapsto s_i\tau\mid x_i\in\domain(\sigma) \}
		\cup
		\{ y_i\mapsto t_i\mid y_i\in\domain(\tau) \backslash \domain(\sigma) \}.
	\end{align*}
\end{definition}

\begin{definition}
	We write $F(x)$ for a clause or formula to express that $\fvar(F) = \{ x \}$
	and we abbreviate $F(x)\{x\mapsto t\}$ with $F(t)$, i.e.~the only free variable in $F$ is substituted with term $t$.
\end{definition}



\begin{lemma}\label{lem:substitution}
	With the definitions in \ref{def:substitution} and \ref{def:substcomp} the equation
	$(\mct\sigma)\tau = \mct(\sigma\tau)$ holds for
	arbitrary first order expressions and substitutions.
\end{lemma}

\begin{proof}
	Assume $\sigma$ and $\tau$ are substitutions. 
	Then we use induction on the structure of an arbitrary expression $\mct$
	that the equation $(\mct\sigma)\tau =  \mct(\tau\sigma)$ holds in all possible cases.
	\begin{itemize}
		\item (base case) Let $\mct = x_i \in\domain(\sigma)$ then
		$((x_i)\sigma)\tau\defEQ s_i\tau\defEQ x_i(\sigma\tau)$ holds.
		
		\item (base case) Let $\mct = y \not\in\domain(\sigma)$ then
		$(y\sigma)\tau \defEQ y\tau \defEQ y(\sigma\tau)$ holds. 
		
		\item (step case) Let $\mct = \mcf(t_1,\ldots,t_n)$ 
		then
		$((\mcf(t_1,\ldots,t_n))\sigma)\tau
		\defEQ 
		(\mcf(t_1\sigma,\ldots,t_n\sigma))\tau
		\defEQ 
		\mcf((t_1\sigma)\tau,\ldots,(t_n\sigma)\tau)
		\defEQ[IH]
		\mcf(t_1(\sigma\tau),\ldots,t_n(\sigma\tau))
		\defEQ
		(\mcf(t_1,\ldots,t_n))(\sigma\tau)
		$ holds.
		
		\item (step case) Let $\mct = \lnot A$ then
		$((\lnot A)\sigma)\tau 
		\defEQ 
		(\lnot(A\sigma))\tau 
		\defEQ 
		\lnot((A\sigma)\tau)
		\defEQ[IH]
		\lnot(A(\sigma\tau))
		\defEQ 
		(\lnot A)(\sigma\tau)
		$ holds.
	\end{itemize}
\end{proof}
