% !TeX root = ../mthesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US

% In the following definitions $\mcf$ denotes a function symbol, a predicate symbol or the equality sign.


\begin{definition}\label{def:substitution}
	A {\myem substitution} $\sigma$ is a mapping from variables $x\in\mcV$ to terms in $\mcTFfV$
	where the {\myem domain }$\domain(\sigma) = \{ x\in\mcV\mid\sigma(x) \neq x \}$ is finite.
	We write substitutions as bindings, e.g.~$\sigma=\{ x_1\mapsto s_1,\ldots,x_n\mapsto s_n \}$
	where $\domain(\sigma)=\{ x_1,\ldots,x_n \}$ and $\sigma(x_i)=s_i$.
	A {\myem variable substitution} is a mapping from $\mcV$ to $\mcV\subseteq\mcTFfV$.
	A {\myem renaming} is a bijective variable substitution.
	A {\myem proper instantiator} is a substitution that is not a variable substitution.
	We define the instance $\mct\sigma$ 
	respectively the application of a substitution $\sigma$ to a literal or term $\foxt$ as follows
	\DEFINE{
		\foxt\sigma
	}{
			s_i 				& \text{if }\foxt=x_i\in\domain(\sigma)
			\\
			y					& \text{if }\foxt=y\in\mcV\,\backslash\domain(\sigma)
			\\
			\foxf(\foxt_1\sigma,\ldots,\foxt_n\sigma)	&\text{if }\foxt=\foxf(\foxt_1,\ldots,\foxt_n) 
			\text{ where  }
			 \foxf\in\mcFn \\
			 \lnot (A\sigma) &\text{if }\foxt = \lnot A, \text{ where } A\text{ is an atom}
			 }

\noindent Further we define the instance of a clause as the multiset of the instances of its literals.

\begin{definition}
	Let $F$ be a formula and $\sigma$ a substitution
	where $\bvar(F)\cap\domain(\sigma) = \emptyset$. Then the application of the substitution to the formula is well defined.
	\DEFINE{
		F\sigma
	}
{
		\lnot(G\sigma) & \text{if }F = \lnot G\\
		(G\sigma) * (H\sigma) & \text{if }F = G * H, *\in \{ \land, \lor, \limp \}\\
		\quantify x(G\sigma) &\text{if }F = \quantify x G, \quantify\in\{ \forall,\exists \}\colG, x\not\in\domain(\sigma)
	}
\end{definition}


%\begin{definition}
%	Let $F = \quantify x G$ and $x \in\fvar(G)$ with $\quantify\in\{ \forall,\exists \}$ 
%\end{definition}

%%% F(x) formula with free variable x
\begin{remark}[\OBSOLETE] 
	We write $F(x)$ for a clause or formula to express that $\fvar(F) \supseteq \{ x \}$
	and we abbreviate $F(x)\{x\mapsto t\}$ with $F(t)$, i.e.~all occurrences 
	of the first and only free variable in $F$ is substituted with term $t$.
\end{remark}


\end{definition}
%\footnotetext{We use prefix and infix notation interchangable, e.g.
%${\mEQ}(s,t)$ represents the same equation as $s\mEQ t$.}

\begin{definition}
	A clause $\mcC$ {\myem strictly subsumes} a clause $\mcD$ if their exists a substitution $\theta$ such that $\mcC\theta \subsetneq \mcD$,
	e.g.~when clause $\mcD = \mcC\theta \lor \mcD'$ is a weakened instance of clause $\mcC$.
\end{definition}
%\begin{example}
%	Trivially any clause $\mcC$ subsumes all its instances $\mcC\sigma$ or weakenings $\mcC\lor\mcD$. 
%	Further $x\mEQ y$ subsumes $x\mEQ x \lor \mP(y)$.
%\end{example}

\begin{definition}\label{def:substcomp}
We define the {\myem composition} of two substitutions $\sigma$ and $\tau$ as follows
	\begin{align*}
		\sigma\tau&=\{ x_i\mapsto s_i\tau\mid x_i\in\domain(\sigma) \}
		\cup
		\{ y_i\mapsto t_i\mid y_i\in\domain(\tau) \backslash \domain(\sigma) \}.
	\end{align*}
\end{definition}

\begin{lemma}\label{lem:substitution}
	With the definitions in \ref{def:substitution} and \ref{def:substcomp} the equation
	$(\mct\sigma)\tau = \mct(\sigma\tau)$ holds for
	term, atoms, and literals.
\end{lemma}

\begin{proof}
	Assume $\sigma$ and $\tau$ are substitutions. 
	Then we use induction on the structure of the 	expression $\mct$
	that the equation $(\mct\sigma)\tau =  \mct(\tau\sigma)$ holds in all possible cases.
	\begin{itemize}
		\item (base case) Let $\mct = x_i \in\domain(\sigma)$ then
		$((x_i)\sigma)\tau\defEQ s_i\tau\defEQ x_i(\sigma\tau)$ holds.
		
		\item (base case) Let $\mct = y \not\in\domain(\sigma)$ then
		$(y\sigma)\tau \defEQ y\tau \defEQ y(\sigma\tau)$ holds. 
		
		\item (step case) Let $\mct = \mcf(t_1,\ldots,t_n)$ 
		then
		$((\mcf(t_1,\ldots,t_n))\sigma)\tau
		\defEQ 
		(\mcf(t_1\sigma,\ldots,t_n\sigma))\tau
		\defEQ 
		\mcf((t_1\sigma)\tau,\ldots,(t_n\sigma)\tau)
		\defEQ[IH]
		\mcf(t_1(\sigma\tau),\ldots,t_n(\sigma\tau))
		\defEQ
		(\mcf(t_1,\ldots,t_n))(\sigma\tau)
		$ holds.
		
		\item (step case) Let $\mct = \lnot A$ then
		$((\lnot A)\sigma)\tau 
		\defEQ 
		(\lnot(A\sigma))\tau 
		\defEQ 
		\lnot((A\sigma)\tau)
		\defEQ[IH]
		\lnot(A(\sigma\tau))
		\defEQ 
		(\lnot A)(\sigma\tau)
		$ holds.
	\end{itemize}
\end{proof}
