% !TeX root = ../mythesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US

\begin{definition}[\FOF]\label{def:syntax:FOF}
	The atoms in Definition~\vref{def:atoms} are \coloremph{first order formulae}.
	The universal quantification \( (\forall x F) \)
	and the existential quantification \( (\exists x F) \)
	of a first order formula are (quantified) first order formulae
	with \coloremph{bound} variable \( x\in\mcV \).
	The negation \( (\lnot F) \) of a first order formula
	is a (composite) first order formula.
	Further, the disjunction \( (F \lor F') \),
	the conjunction \( (F \land F')  \),
	and the implication \( (F \limp F') \)
	of two first order formulae
	are (composite) first order formulae, where 
%
	we refer to formulae \(F \) and \( F' \) as \coloremph{subformulae} of
	the quantified or composite formulae above.
\end{definition}

\begin{remark}
	The symbol \( \limp \) for implication is not to be confused
	with the equational symbol for rewrite rules in Section~\ref{sec:termrewriting}.
\end{remark}

\begin{definition}\label{def:fof:fvars}\label{def:fof:bvars}
	We define the set of \coloremph{free} variables and the set of \coloremph{bound} variables
	of a first order formula \( F \) as follows:
\begin{gather*}
	\MDEFINE{\fvar(F)}{ll}{
		\bigcup_{i=1}^n \var(t_i)
		&\text{if }F
		= \mP(t_1,\ldots,t_n), \mP\in\mcFPn
		\\
		\var(t_1)\cup\var(t_2)
		&\text{if }F
		= t_1\mEQ t_2
		\\
		\fvar(G)&\text{if }F = \lnot G
		\\
		\fvar(G) \cup \fvar(H)&\text{if }F \in \{ \, G\land H,G \lor H,G\limp H \, \}
		\\
		\fvar (G) \setminus \{ x\} &\text{if } F \in \{ \, \forall x \, G, \exists x \, G \, \}
	}
	\\
\MDEFINE{\bvar(F)}{ll}{
	\emptyset &\text{if }F = \mP(t_1,\ldots,t_n), \mP\in\mcFPn
	\\
	\emptyset &\text{if }F = t_1\mEQ t_2
	\\
	\bvar(G)&\text{if }F = \lnot G
	\\
	\bvar(G) \cup \bvar(H)&\text{if }F \in \{ \, G \land H, G \lor H, G \limp H \, \}
	\\
	\{ x\} \cup \bvar (G) &\text{if } F \in \{ \, \forall x \, G, \exists x\,G \, \}
}
\end{gather*}
\end{definition}

\begin{example}
	With formula \( F = (\forall x (x\mEQ y)) \lor (\exists y \mP(x,y)) \)
	we have \( \fvar(F) = \bvar(F) \), which we would like to avoid.
	In Section~\vref{sec:semantics} we will see that formula
	\( F' = (\forall x (x\mEQ y')) \lor (\exists y \mP(x',y)) \)
	is equivalent to our first formula F
	and we get
	\( \fvar(F') \cap \bvar(F') = \emptyset \).
	%	 = \{ x, y\}$.
\end{example}

%\begin{remark}
We often will use formulae or sentences
without stating the signature.
The reader can easily deduce the underlying \coloremph{implicit} signature with arities
and the set of variables by applying the definitions of the syntax for first order formulae.
We follow the convention to use \( x,y,z \) for variables
and \( \ma,\mb,\mc \) for constant function symbols
(which avoids ambiguity in the presence of free variables).
For easier readability we will use
uppercase predicate symbols \(\mP,\mQ \) and
lowercase function symbols \( \mf,\mg,\mh \) with indices.
We may denote \( \mcF(F) \) for the implicit signature of an formula \( F \).
%\end{remark}

\begin{definition}\label{def:fof:closed}\label{def:fof:sentence}
	A first order formula is closed, i.e.~a first order \coloremph{sentence},
	if and only if it does not contain free variables, 
	i.e.~all occurring variables are bound.
	For practical reasons we assume that all the occuring variables of a sentence
	are bound exactly once
	and are free variables
	in the subformulae of the quantified formulae where they were bound.
	Thus the following will be assured.
	\begin{align*}
		\fvar(\phi) &= \emptyset
		\text{ iff }\phi\text{ is a sentence}
		\\
		\bvar(G \connect H) &= \bvar(G)\disjointunion\bvar(H)
		&\connect& \in \SetOfConnectives
		\\
		\bvar(\quantify x F) &= \{x\}\disjointunion\bvar(F)
		&\quantify& \in \SetOfQuantifiers
		\\
		\quantify x F &\Rightarrow
		x\in\fvar(F), x\not\in\bvar(F)
		&\quantify& \in \SetOfQuantifiers
	\end{align*}
\end{definition}

\begin{example}The sentences on the left do not match
	the assumptions in Definition~\vref{def:fof:sentence}
	but their {equivalent (see Definition~\vref{def:equivalence})}
	counterparts on the right do.
	\[
	\begin{array}{rrcll}
		 \text{\color{colLo}{\xmark}}
		& \forall x\, ({\mP(x) \lor \forall x\, {\mQ(x)}})
		& {\equiv}
		& \forall x\, ({\mP(x) \lor \forall y\, {\mQ(y)}})
		& \text{\color{colHi}{\cmark}}
		\\ \text{\color{colLo}{\xmark}}
		& (\forall x\, {\mP(x)}) \lor (\forall x\, {\mQ(x)})
		& {\equiv}
		& (\forall x\, {\mP(x)}) \lor (\forall y\, {\mQ(y)})
		& \text{\color{colHi}{\cmark}}
		\\
		\text{\color{colLo}{\xmark}}
		&  \forall x\, {\mP(\ma)}
		& {\equiv}
		& \mP(\ma)
		& \text{\color{colHi}{\cmark}}
	\end{array}
	\]

\end{example}

\begin{definition}[\PNF]
	A first order sentence \( F = \quantify_1 x_1 \ldots \quantify_n x_n\, G \)
	with \( n \) quantifiers \( \quantify_i \in \{ \exists, \forall \} \),
	\( n \) bound and distinct variables \( x_i \),
	and quantifier free subformula \( G \) with
	a matching set of free variables, i.e.~\( \fvar(G) = \bvar(F) \),
	is in \coloremph{prenex normal form}.
\end{definition}


