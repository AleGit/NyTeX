% !TeX root = ../mthesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US

\begin{definition}\label{def:position}
	A {\myem position} is a finite sequence of positive integers.
	The root position is the empty sequence $\epsilon$.
	The position $pq$ is obtained by concatenation of positions $p$ and $q$.
	%
	A position $p$ is {\myem above} a position $q$ if $p$ is a prefix of $q$, 
	i.e.~there exists a unique position $r$ such that $pr = q$, 
	we write $p\leq q$ and $q\backslash r = p$.
	We write $p<q$ if $p$ is a proper prefix of $q$, i.e.~$p\leq q$ but $p\neq q$.
	We define $\head(iq)=i$ and $\tail(iq) = q)$ for $i\in\mathbb{N}$, $q\in\mathbb{N}^*$,
	further $\length(\epsilon)=0$, $\length(iq) = 1 + \length(q)$.
%	
	Two positions $p\parallel q$ are parallel if none is above the other,
	i.e.~for any common prefix $r$ both remaining tails
	$p\backslash r$ and $q\backslash r$ are different and not root positions.
	A position $p$ is left of position $q$ if $\head(p\backslash r) < \head(p\backslash r)$ 
	for maximal common prefix $r$. 
	
\end{definition}
\begin{definition}
	
	We define the set of {\myem term positions} in an atom or a term,
	\DEFINE{ 
		\pos(\foxt) }
	{
		\{ \epsilon \} 		
		& \text{if }\foxt = x \in \mcV\\
		%		
		\{ \epsilon \} \cup\, \bigcup_{i=1}^{n} \{ iq\mid q\in\pos(t_i) \}	
		&	\text{if }\foxt=\mf(t_1,\ldots,t_n), \mf\in\mcFfn\\
		%		
%		{\colG\xcancel{\{ \epsilon \}\, \cup }}
%		\bigcup_{i=1}^{n} \{ iq\mid q\in\pos(t_i) \}	
%		&	\text{if }\foxt=\mP(t_1,\ldots,t_n), \mP\in\mcFPn\\
		%		
		{\colG\pdfmarkupcomment[markup=StrikeOut,color=red,author=ALM]{
			\{ \epsilon \} \cup}{}}
		\bigcup_{i=1}^{n} \{ iq\mid q\in\pos(t_i) \}
		&	\text{if }\foxt=\mP(t_1,\ldots,t_n), \mP\in\mcFPn\\
		%		
%		{\colG\xcancel{\{ \epsilon \}\, \cup }}\{ 1q \mid q\in\pos(t_1) \} \cup \{ 2q \mid q\in\pos(t_2) \}	
%		&	\text{if }\foxt=t_1\mEQ t_2\\
		%		
		{\colG\pdfmarkupcomment[markup=StrikeOut,color=red,author=ALM]{
			\{ \epsilon \} \cup}{}}
		\{ 1q \mid q\in\pos(t_1) \} \cup \{ 2q \mid q\in\pos(t_2) \}	
		&	\text{if }\foxt=t_1\mEQ t_2
	}
	the extraction of a subterm at a term position from an atom or a term,
%	
	\DEFINE{
		\foxt|_p
	}{
		\foxt 		& \text{if }p=\epsilon \\
		\foxt_i|_q	& \text{if }t=\foxf(t_1,\ldots,t_n), p=iq, \foxf\in\mcFn
	}
	%
	and the insertion of a term $s$ at a term position into an atom or a term
	by replacing the subterm at that term position.
	\DEFINE{
		\foxt[s]_p}
	{
		s 		& \text{if }p=\epsilon, \colG(\mct\text{ is a term}) \\
		\foxf(\foxt_1,\ldots,\foxt_i[s]_q,\ldots,\foxt_n)	& \text{if }t=\foxf(\foxt_1,\ldots,\foxt_n), p=iq, 
		\foxf\in\mcFn, 0 < i \leq n
	}
%where $p\neq\epsilon$ if $\foxt$ is an atom.
	%A {\myem hole} denotes a special constant symbol $\ctxhole\in\mcFf^{(0)}$. 
	%A {\myem context} is a term $t$ with exactly one hole, i.e.~one occurrence $|t|_{\ctxhole}=1$.
\end{definition}