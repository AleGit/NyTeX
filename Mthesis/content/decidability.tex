% !TeX root = ../mthesis.tex
% !TeX encoding = UTF-8
% !TeX spellcheck = en_US


\chapter{Completeness and Undecidability}

We call a logical calculus, i.e.~a formal proof system for an underlying logic, 
{\myem complete} if every valid formula is provable.
In other words, any expression that is satisfied by all possible interpretations 
is deducible or justifiable by applying rules of the formal system only.
We expect a useful calculus to be {\myem sound}, that is, every proven formula is valid, 
i.e.~it holds in any interpretation.
We call a logical system {\myem decidable} 
if and only if a purely syntactical algorithm exists that determines 
the validity or non-validity for any arbitrary formula in the given logical system.
%A standard example for a decidable logic is propositional logic.

We first look at a sound and complete calculus for first-order logic in \ref{sec:natural:deduction}.
After that we recall undecidability of first-order logic in \ref{sec:decidable:fol:theorems} 
together with other useful theorems about first-order logic.
Then we enumerate decidable fragments of first-order logic
which can be described purely syntactically in \ref{sec:decidable:fol:fragments} .
After that we look at decidable first-order theories in \ref{sec:decidable:fol:theories}, 
which are not necessarily expressible 
in one of the syntactically describable and decidable fragments of first-order logic.

\section{\gls{Natural Deduction}}
\label{sec:natural:deduction}

In Natural Deduction \cite{Huth:2004:LCS:975331}
we start with a (possible empty) set of formulae -- the premises -- 
and infer other formulae -- the conclusions -- by using syntactic proof rules from Tables 
\ref{tab:natural:deduction:connectives}, \ref{tab:natural:deduction:equality}, 
and \ref{tab:natural:deduction:quantifiers}.
The symbols $F$ and $G$ in these rules represent arbitrary first-order formula 
as defined in Definition \vref{def:syntax:FOF}. 
We open a box when we assume something, e.g.~that $F$ holds. 
We close the box when we discard the assumption. 
With $F_1,\ldots,F_n \proves H$ we claim that formula $H$ 
is in the transitive closure of inferable formulae from $\{ F_1,\ldots,F_n\}$.
(e.g.~the natural deduction proof to Lemma \vref{lemma:equivalence:congruence}).

\input{decidability/NaturalDeductionRules}

\begin{theorem}[Soundness]
	The inference rules of natural deduction are sound.
\end{theorem}

\section{Theorems of First Order Logic}\label{sec:decidable:fol:theorems}

The purpose of this section is to state useful theorems about first-order logic.

\begin{theorem}[Completeness, Gödel 1929]
	Natural deduction (see above), a sound formal system, is complete.
\end{theorem}

\begin{theorem}
	[Undecidability, Church 1936, Turing 1937]
	The satisfiability problem for first-order logic is undecidable.
\end{theorem}

\begin{theorem}[Trakhtenbort 1950, Craig 1950]
	The satisfiability problem for first-order logic on {\myem finite} structures (domains) is undecidable.
\end{theorem}

\begin{definition}[Finite model property]
	A logic has the finite model property if each non-theorem is falsified by some finite model.
\end{definition}

\begin{lemma}[Refutation]
	By definition of the semantics of negation a formula is valid if and only if its negation is not satisfiable.
\end{lemma}

\begin{theorem}[Compactness, Gödel 1930, Maltsev 1936]\label{the:compactness}
	If every finite subset of a set of formulas $S$ has a model then $S$ has a model. 
\end{theorem}

\begin{theorem}[Löwenheim Skolem, 1915, 1920]\label{the:loewenheim}
	If a set of formulas $S$ has a model then $S$ has a countable model.
\end{theorem}

\begin{theorem}[Herbrand, 1930]\label{the:herbrand}
	Let $S$ be a set of clauses without equality. Then the following statements are equivalent.
	\begin{itemize}
		\item $S$ is satisfiable.
		\item $S$ has a Herbrand model.
		\item Every finite subset of all ground instances of $S$ has a Herbrand model.
	\end{itemize} 
\end{theorem}

\begin{corollary}
	Let $S$ be a set of clauses without equality. 
	Then $S$ is unsatisfiable if and only if there exists 
	an unsatisfiable finite set of ground instances of $S$.
\end{corollary}

\begin{lemma}
With Skolemization and Tseitin transformation we can effectively transform a arbitrary first-order formula into an equisatisfiable set of clauses.	
\end{lemma}


\section{Decidable Fragments of First Order Logic}\label{sec:decidable:fol:fragments}

This section presents purely syntactical defined fragments
of first-order logic where satisfiability is decidable.\footnote{
	\,Definitions and compact overviews follow the presentation
	“\href{http://logic.rwth-aachen.de/~graedel/kalmar.pdf}{Decidable fragments of first-order and fixed-point logic}”
	by E.~Grädel (\url{http://logic.rwth-aachen.de/~graedel/}).	
}  



\begin{definition}[\PNF]
	A first-order formula $F = \quantify_1 x_1 \ldots \quantify_n x_n\, G$ 
	where $\quantify_i \in \{\exists,\forall\}$ are quantifiers
	for $1 < i \leq n$,
	the subformula $G$ is quantifier free, and 
	the set of free variables $\fvar(G) = \{ x_1, \ldots, x_n \}$
	matches the quantified variables
	is in {\myem prenex normal form}.
\end{definition}


\begin{definition}[\cite{MR1482227}]\label{def:prefix:class}
	We describe classes of first-order formulae in \PNF with triples
	\[
	[\, \Pi, (p_1,p_2,\ldots), (f_1,f_2,\ldots)\,]_{(\mEQ)} \subseteq [\, all, all, all\,]_{\mEQ}
	\]
	where $\Pi = \quantify_1 \ldots \quantify_n$, $\quantify_i\in\{\forall,\exists\}$ 
	describes the structure of the quantifier prefix (without variables) of the formulae,
	the value $p_i$ is the maximal number of predicate symbols with arity $i$,
	and the value $f_i$ the maximal number of function symbols with arity $i$ in the signature.
	The equality symbol is not counted as binary predicate symbol. Instead,
	the absence or presence of subscript $(\mEQ)$ indicates whether the equality symbol is in the signature. 
\end{definition}

\begin{example}\label{ex:monadic}
	The monadic predicate calculus includes formulae with arbitrary quantifier prefixes, 
	arbitrary many unary predicate symbols, the equality symbol, but no function symbols.
	\begin{gather*}
	{\colG [\,all, (\omega), (1)\,]_= 
	\quad\supsetneq}\qquad 
	[\,all, (\omega), (0 ) \,]_=
	\tag{Löwenheim 1925, Kalmár 1929}
	\end{gather*}
\end{example}

\begin{example}\label{ex:ackermann}
	The Ackermann prefix class contains formulae with arbitrary many existential quantifiers, 
	but just one universal quantifier. It contains arbitrary many predicate symbols
	with arbitrary arities, the equality symbol, but no function symbols. 
	\begin{gather*}
	{\colG [\,\exists^*\forall\exists^*,all,(1)\,]_=
	\quad\supsetneq}\qquad
	[\,\exists^*\forall\exists^*,all,(0) \,]_{=}\qquad\qquad\qquad 
	\tag{Ackermann 1928}
	\end{gather*}
\end{example}

\begin{remark}
	One unary function symbol can be added to these fragments of first order logic above 
	without loosing decidability (see Table \vref{tab:decidable:InfinityAxioms}).
\end{remark}

%Goldfarb, Gurevich, Rabin, Shelah completly characterized decidable and undecidable prefix classes.

\begin{table}[hbt]
	\begin{align*}
	%\colG [\,all, (\omega), (0 )&\colG\,]_= \tag{Löwenheim 1925, Kalmár 1929}
	%\\
	[\,\exists^{∗}\forall^{∗}, all, (0)&\,]_{=} \tag{Bernays, Schönfinkel 1928, Ramsey 1932}
	\\
	[\,\exists^{∗}\forall^2\exists^{∗} , all, (0)&\,] \tag{Gödel 1932, Kalmár 1933, Schütte 1934}
	\\
	[\,all, (\omega), (\omega)&\,] \tag{Löb 1967, Gurevich 1969}
	\\
	[\,\exists^{∗}\forall\exists^{∗}, all, all&\,] \tag{Gurevich 1973}
	\\
	[\,\exists^{∗}, all, all&\,]_{=} \tag{Gurevich 1976}
	\end{align*}
	%\caption[Decidable prefix classes]{Decidable prefix classes in first-order logic}
	\caption[Decidable prefix classes]{Decidable prefix classes with final model property }
	\label{tab:decidedable:FiniteModelProperty}
\end{table}

\begin{table}[hbt]
	\begin{align*}
	[\,all, (\omega), (1)&\,]_{=} \tag{Rabin 1969} 
	\\
	[\,\exists^{∗}\forall\exists^{∗}, all, (1)&\,]_{=} \tag{Shelah 1977}
	\end{align*}
	%\caption[Decidable prefix classes]{Decidable prefix classes in first-order logic}
	\caption[Decidable prefix classes]{Decidable prefix classes with infinity axioms. }
	\label{tab:decidable:InfinityAxioms}
\end{table}

\begin{lemma}
	Satisfiability is decidable \cite{MR1482227} in all prefix classes from Tables 
	\ref{tab:decidedable:FiniteModelProperty} and \ref{tab:decidable:InfinityAxioms}.
	Each of theses classes is closed under conjunction with respect to satisfiability.
\end{lemma}



\section{Theories in First Order Logic}\label{sec:decidable:fol:theories}

We follow definitions and examples in \cite{AM2015L}.

\begin{definition}[Theory]
	A {\myem first-order theory} is a pair of a first-order signature 
	and the possible infinite conjunction $\bigwedge_i A_i$ of first-order formulae, 
	i.e.~the axioms, over the theory's signature. 
	A theory is satisfiable if there exists a model for its axioms.
	A theory is consistent when the contradiction is not derivable.
%	
	A {\myem theorem} is a sentence over the theory's signature, 
	i.e.~a closed formula, that holds in any model for the theory's axioms.
	\[
		\bigwedge_i A_i \models \mathsf{theorem} 
		\quad\text{ or }\quad
		\bigwedge_i A_i \limp \mathsf{theorem} 
	\]
	A theory is decidable if it is decidable whether an arbitrary sentence holds in the theory.
\end{definition}

\begin{example}
A theory with axioms $\forall x\,\mP(x)$ and $\exists x\,\lnot\mP(x)$ is not satisfiable,
but every sentence is a theorem. Hence it is not consistent, too.
\end{example}
%
\begin{remark} 
In refuational theorem proving
we show the unsatisfiabilty 
of a negated sentence, 
i.e.~a {\myem conjecture},
in conjunction with the axioms
to conclude that the conjecture is indeed a theorem.
\[
	\lnot\left(\bigwedge_i A_i \limp \mathsf{conj}\right) \equiv
	\lnot\left(\lnot\bigwedge_i A_i \lor \mathsf{conj}\right) \equiv
	\bigwedge_i A_i \land \lnot \mathsf{conj}
\]
\end{remark}

In the following we define equivalence and congruence as usual. Together these axioms form the theory of equality.

\begin{definition}
	[Equivalence]
	\label{def:equivalence:axioms}
\begin{align*}
\forall x\, 
&\left(x \mEQ x\right) 
\tag*{reflexivity}
\\
\forall x \forall y\, 
&\left(x \mEQ y \limp y \mEQ x \right)
\tag*{symmetry} 
\\
\forall x \forall y \forall z\,
&\left(x \mEQ y \land y\mEQ z \limp x\mEQ z\right) 
\tag*{transitiviy}
\end{align*}
\end{definition}

\begin{definition}[$\vec{x}$-Notation]
	Occasionally we may abbreviate a sequence of $n$ variables by $\vec{x}$.
	Then we write $\mcf(\vecn{x})$ 
	for first-order expression $\mcf(x_1,\ldots,x_n)$
	with n-ary function or predicate symbol $\mcf$,
%	 $\mcf\in\mcFn$,
	a single equation $\vecn{x}\mEQ\vecn{y}$ for
	the conjunction of $n$ equations 
	$x_1\mEQ y_1\land\ldots\land x_n\mEQ y_n$,
	and $\forall\vecn{x}$ for 
	the sequence of quantified variables $\forall x_1\ldots\forall x_n$.
\end{definition}

\begin{definition}
	[Congruence schemata]
	\label{def:congruence:schemata}
	\begin{align*}
	\forall\vecn{x}\,\forall\vecn{y}\,
	&\left(\vecn{x}\mEQ\vecn{y} \limp \mf(\vecn{x}) \mEQ \mf(\vecn{y}) \right)
	\tag*{for all $\mf\in\mcFfn$}
	\\
	\forall\vecn{x}\,\forall\vecn{y}\, 
	&\left(\vecn{x}\mEQ\vecn{y} \limp (\mP(\vecn{x}) \limp \mP(\vecn{y}))\right)
	\tag*{for all $\mP\in\mcFPn$}
	\end{align*}
	
	
\end{definition}

%\begin{remark}For simplicity we have replaced biconditionals in symmetry and predicate congruence with implications.
%	\begin{align*}
%	\forall x \forall y\,
%	\left(x \mEQ y \lbic y \mEQ x \right) 
%	&
%	\equiv\forall x \forall y\,
%	\left(x \mEQ y \limp y \mEQ x \right)
%	\\
%	\forall\vec{x}\,\forall\vec{y}\, 
%	\left(\vec{x}\mEQ\vec{y} \limp (\mP(\vec{x}) \lbic \mP(\vec{y}))\right)
%	&\equiv
%	\forall\vec{x}\,\forall\vec{y}\,
%	\left(\vec{x}\mEQ\vec{y} \limp (\mP(\vec{x}) \limp \mP(\vec{y}))\right)
%	\end{align*}
%\end{remark}
%
\begin{lemma}\label{lemma:equivalence:congruence}
Equivalence and congruence of equality are provable by Natural Deduction (see Section \vref{sec:natural:deduction}).\end{lemma}
\begin{proof}
	For brevity we skip the quantifier introductions for symmetry, transitivity, and congruence.
	Additionally we just show congruence for a unary function and a unary predicate symbol.
	\begin{gather*}
\begin{BMAT}{rcrclccl}{cc}
1 && x_0 && x_0=x_0 	& && {=}i\\
2 && 	 &&	\forall x\,(x=x)	& && \forall{}i,1
\addpath{(2,1,1)rrrrulllld}
\end{BMAT}
\\
\begin{BMAT}{rcrclccl}{ccccccc}
1 && && y = y   & && {=}i\\
2 && && x = y	& && \texttt{assume}\\
3 && &&	y\neq x	& && \texttt{assume}\\
4 && && y\neq y & && {=}e,2,3\\
5 && && \bot    & && {\lnot}e,1,4 \\
6 && && y = x   & && \texttt{PBC}, 3{-} 5\\
7 && && x = y \limp y = x & && {\limp}i, 1{-} 5
\addpath{(2,1,1)rrrruuuuullllddddd}
\addpath{(3,2,1)rruuullddd}
\end{BMAT}
\qquad
\begin{BMAT}{rcrclccl}{ccccc}
1 &&     && x=y\land y=z 	& && \texttt{assume}\\
2 && 	 &&	y=z	& && \land{}e_2 \\
3 && 	 &&	x=y	& && \land{}e_1, 2 \\
4 && 	 &&	x=z	& && {=}e,2,3 \\
5 && 	 &&	x=y\land y=z\limp x=z	& && {\limp}i,2{-}4 
\addpath{(2,1,1)rrrruuuulllldddd}
\end{BMAT}
\\
\begin{BMAT}{rcrclccl}{ccccccc}
1 && && \mf(y) = \mf(y)   & && {=}i\\
2 && && x = y	& && \texttt{assume}\\
3 && &&	\mf(x) \neq \mf(y)	& && \texttt{assume}\\
4 && && \mf(y) \neq \mf(y) & && {=}e,2,3\\
5 && && \bot    & && {\lnot}e,1,4 \\
6 && && \mf(x) = \mf(y)   & && \texttt{PBC}, 3{-} 5\\
7 && && x = y \limp \mf(x) = \mf(y) & && {\limp}i, 1{-} 5
\addpath{(2,1,1)rrrruuuuullllddddd}
\addpath{(3,2,1)rruuullddd}
\end{BMAT}
\qquad
\begin{BMAT}{rcrclccl}{ccccc}
1 && && x = y	& && \texttt{assume}\\
2 && &&	\mP(x)	& && \texttt{assume}\\
3 && && \mP(y) & && {=}e,1,2\\
4 && && \mP(x) \limp \mP(y)   & && {\limp}i, 2{-} 3\\
5 && && x = y \limp (\mP(x)\limp\mP(y)) & && {\limp}i, 1{-} 4
\addpath{(2,1,1)rrrruuuulllldddd}
\addpath{(3,2,1)rruulldd}
\end{BMAT}
\end{gather*}
\end{proof}

\begin{definition}
	[Natural Numbers]
	\label{def:natural:numbers:axioms}
	We introduce a fresh constant $0\in\mcFn[0]$, 
	a unary successor symbol $\msucc\in\mcFn[1]$,
	and restrict their models with two axioms. 
\begin{align*}
\forall x\, &(\msucc(x) \mNE 0)
\tag*{zero is smallest} 
\\ %–––––––––––––––––––––––––––
\forall x \forall y\, &(\msucc(x) \mEQ \msucc(y) \limp x \mEQ y)
\tag*{injectivity of $\msucc$}
\\
\colG\forall x\forall y\,&\colG(x\mEQ y \limp \msucc(x)\mEQ\msucc(y))
\tag*{congruence of $\msucc$}
\\ 
\underbrace{G(0)}_{\text{base}} 
\land\, \forall x\,&
\underbrace{
	\left(G(x) \limp G(\msucc(x))\right)
}_{\text{step case}}
\,\limp\, \forall y\,G(y)
\tag*{induction schema}
\end{align*}
\end{definition}

\begin{definition}
	[Addition]
	\label{def:addition:axioms}
	We introduce the binary addition symbol $+\in\mcFfn[2]$ with two axioms about defining equalities of sums.
\begin{align*}
\forall x\,
&(x+0 \mEQ x) 
\tag*{addition of zero}\\
\forall x\forall y\,
&(x+\msucc(y)) \mEQ \msucc(x+y)
\tag*{addition of non-zero}
\\
\colG\forall x_1\forall x_2\forall y_1\forall y_2\,
&\colG (x_1\mEQ y_1\land x_2\mEQ y_2 \limp x_1+y_1\mEQ x_2+y_2)
\tag*{congruence of $+$}
\end{align*}
\end{definition}

\begin{example}
	\begin{gather*}
	{\colG \msucc(\msucc(\msucc(0)))} + \msucc(\msucc(0))
	\mEQ\msucc({\colG \msucc(\msucc(\msucc(0)))} + \msucc(0)) 
	\mEQ \msucc(\msucc(
	{\colG \msucc(\msucc(\msucc(0)))} + 0))
	\mEQ \msucc(\msucc(
	{\colG \msucc(\msucc(\msucc(0)))}))
	\end{gather*}
	\end{example}

\begin{theorem}Presburger Artihmetic (Moj\'{z}esz Presburger, 1929), i.e.~the first-order theory with natural numbers, induction schemata, and addition, is consistent, complete and decidable. The computational complexity of the decision problem is at least doubly exponential $2^{2^{cn}}$(Fischer and Rabin, 1974), but less than triple exponential (Oppen, 1978. Berman, 1980).
\end{theorem}

\begin{definition}
	[Multiplikation]
	\label{tab:addition:axioms}
	We introduce the binary multiplication symbol $\times\in\mcFfn[2]$
	with two axioms about defining equalities of products.
	\begin{align*}
	\forall x\,
	&(x\times 0 \mEQ 0) 
	\tag*{multiplication by zero}\\
	\forall x\forall y\,
	&(x\times\msucc(y) \mEQ (x\times y) + x)
	\tag*{multiplication by non-zero}
	\\
	\colG\forall x_1\forall x_2\forall y_1\forall y_2\,
	&\colG (x_1\mEQ y_1\land x_2\mEQ y_2 \limp x_1\times y_1\mEQ x_2 \times y_2)
	\tag*{congruence of $\times$}
	\end{align*}
\end{definition}

\begin{theorem}Peano Artihmetic (Guiseppe Peano, 19th century), 
	i.e.~the first-order theory with natural numbers, induction schemata, addition, and multiplication, is incomplete (Gödel) and undecidable. 
\end{theorem}

\begin{theorem}
	The axioms of Peano Artihmetic appear consistent (Gentzen, 1936).
\end{theorem}

\begin{lemma}[ACN]\label{lem:acn}
	Addition and Multiplication on natural numbers are associative, commutative, 
	and determine neutral elements.
	\begin{align*}
	\forall x\forall y\forall z\,&(x\circ(y\circ z) \mEQ (x\circ y)\circ z) 
	\tag*{associativity of $\circ\in\{+,\times\}$}
	\\
	\forall x\forall y\,&(x\circ y \mEQ y\circ x)
	\tag*{commutativity of $\circ\in\{+,\times\}$}
	\\
	\forall x\,&(x + 0\mEQ x \land 0 + x \mEQ x )
	\tag*{neutral element for $+$}
	\\
	\forall x\,&(x \times \msucc(0)\mEQ x \land \msucc(0) \times x \mEQ x )
	\tag*{neutral element for $\times$}
	\end{align*}
\end{lemma}

%\begin{proof}by induction
%	\begin{align*}
%	0 + 0 \mEQ 0
%	\tag*{$\forall e$}
%	\\
%	0+x\mEQ x\tag*{assumption}
%	\\
%	0+\msucc(x)\mEQ \msucc(x)
%	\\
%	(0 + 0 \mEQ 0)
%	\land
%	\forall x\,(0+x\mEQ x \limp 0+\msucc(x)\mEQ\msucc(x))
%	\limp
%	\forall y\,(0+y\mEQ y)
%	\tag*{induction}
%	\end{align*}
%\end{proof}










